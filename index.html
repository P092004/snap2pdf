<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snap2PDF - Indiaâ€™s Smart PDF Converter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    .glass { backdrop-filter: blur(10px); background: rgba(255, 255, 255, 0.78); }
    .dropzone-active { border-color: rgb(37 99 235); background-color: rgb(239 246 255); }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <header class="sticky top-0 z-50 border-b border-slate-200 bg-white/90 backdrop-blur">
    <nav class="mx-auto flex max-w-7xl items-center justify-between px-4 py-4 md:px-6">
      <div class="flex items-center gap-2">
        <div class="flex h-9 w-9 items-center justify-center rounded-lg bg-blue-600 text-white font-bold">S</div>
        <div>
          <p class="font-bold leading-none">Snap2PDF</p>
          <p class="text-xs text-slate-500">Built in India ðŸ‡®ðŸ‡³</p>
        </div>
      </div>
      <div class="hidden gap-6 text-sm md:flex">
        <a href="#converter" class="hover:text-blue-600">Converter</a>
        <a href="#auth" class="hover:text-blue-600">Account</a>
        <a href="#features" class="hover:text-blue-600">Features</a>
        <a href="#pricing" class="hover:text-blue-600">Pricing</a>
      </div>
      <a href="#converter" class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700">Try Now</a>
    </nav>
  </header>

  <main>
    <section class="bg-gradient-to-br from-blue-700 via-blue-600 to-indigo-700 text-white">
      <div class="mx-auto grid max-w-7xl gap-10 px-4 py-16 md:grid-cols-2 md:px-6 md:py-20">
        <div>
          <p class="mb-4 inline-block rounded-full bg-white/15 px-3 py-1 text-xs font-semibold">Startup-ready PDF tools for India</p>
          <h1 class="mb-5 text-4xl font-bold leading-tight md:text-5xl">Fast image to PDF conversion with deployment-ready backend.</h1>
          <p class="mb-8 text-blue-100">Single project includes modern frontend + Node backend APIs (signup/login, usage limits, pro activation) so you can launch faster.</p>
          <div class="flex flex-wrap gap-3">
            <a href="#converter" class="rounded-lg bg-white px-5 py-3 font-semibold text-blue-700 hover:bg-slate-100">Start Converting</a>
            <a href="#auth" class="rounded-lg border border-white/60 px-5 py-3 font-semibold hover:bg-white/10">Create Account</a>
          </div>
        </div>
        <div class="glass rounded-2xl border border-white/30 p-5 shadow-2xl">
          <h2 class="mb-4 text-lg font-semibold text-slate-800">Live product highlights</h2>
          <ul class="space-y-3 text-sm text-slate-700">
            <li class="rounded-lg bg-white p-3">âœ… Drag and drop image upload</li>
            <li class="rounded-lg bg-white p-3">âœ… Reorder pages before conversion</li>
            <li class="rounded-lg bg-white p-3">âœ… Auth API + usage limits + Pro mode</li>
            <li class="rounded-lg bg-white p-3">âœ… Ready for Render/Railway deployment</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="auth" class="mx-auto max-w-5xl px-4 py-10 md:px-6">
      <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow md:p-7">
        <div class="mb-4 flex items-center justify-between">
          <h2 class="text-2xl font-bold">Account (Backend Connected)</h2>
          <span id="authBadge" class="rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700">Guest</span>
        </div>
        <div class="grid gap-3 md:grid-cols-4">
          <input id="name" placeholder="Name" class="rounded-lg border border-slate-300 px-3 py-2" />
          <input id="email" placeholder="Email" class="rounded-lg border border-slate-300 px-3 py-2" />
          <input id="password" type="password" placeholder="Password" class="rounded-lg border border-slate-300 px-3 py-2" />
          <div class="grid grid-cols-2 gap-2">
            <button id="signupBtn" class="rounded-lg bg-blue-600 px-3 py-2 text-sm font-semibold text-white hover:bg-blue-700">Sign Up</button>
            <button id="loginBtn" class="rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-700">Login</button>
          </div>
        </div>
        <div class="mt-3 flex flex-wrap gap-3">
          <button id="activateProBtn" class="rounded-lg bg-amber-500 px-4 py-2 text-sm font-semibold text-white hover:bg-amber-600">Activate Pro (Demo)</button>
          <button id="logoutBtn" class="rounded-lg bg-slate-700 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800">Logout</button>
          <p id="authMessage" class="self-center text-sm text-slate-600"></p>
        </div>
      </div>
    </section>

    <section id="converter" class="mx-auto max-w-5xl px-4 py-2 md:px-6">
      <div class="mb-6 text-center">
        <h2 class="text-3xl font-bold">Image to PDF Converter</h2>
        <p class="mt-2 text-slate-600">Upload images, reorder pages, convert instantly, and download.</p>
      </div>

      <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-lg md:p-8">
        <label id="dropzone" for="fileInput" class="mb-6 block cursor-pointer rounded-xl border-2 border-dashed border-slate-300 p-8 text-center transition hover:border-blue-500 hover:bg-blue-50">
          <p class="text-lg font-semibold">Drop images here or click to upload</p>
          <p class="mt-1 text-sm text-slate-500">JPG, PNG, WEBP â€¢ Multiple files supported</p>
          <input id="fileInput" type="file" accept="image/*" multiple class="hidden" />
        </label>

        <div class="mb-6 grid gap-4 md:grid-cols-3">
          <div>
            <label for="pageSize" class="mb-1 block text-sm font-medium">Page size</label>
            <select id="pageSize" class="w-full rounded-lg border border-slate-300 px-3 py-2">
              <option value="a4">A4</option>
              <option value="letter">Letter</option>
            </select>
          </div>
          <div>
            <label for="margin" class="mb-1 block text-sm font-medium">Margin (mm)</label>
            <input id="margin" type="number" min="0" max="30" value="10" class="w-full rounded-lg border border-slate-300 px-3 py-2" />
          </div>
          <div>
            <label for="quality" class="mb-1 block text-sm font-medium">Image quality</label>
            <input id="quality" type="range" min="0.4" max="1" step="0.1" value="0.8" class="mt-2 w-full" />
          </div>
        </div>

        <div id="preview" class="mb-6 grid min-h-[80px] grid-cols-2 gap-3 rounded-xl bg-slate-50 p-3 md:grid-cols-4"></div>

        <div class="grid gap-3 md:grid-cols-3">
          <button id="convertBtn" class="rounded-lg bg-blue-600 px-4 py-3 font-semibold text-white hover:bg-blue-700">Convert to PDF</button>
          <button id="downloadBtn" class="hidden rounded-lg bg-emerald-600 px-4 py-3 font-semibold text-white hover:bg-emerald-700">Download PDF</button>
          <button id="clearBtn" class="rounded-lg bg-slate-700 px-4 py-3 font-semibold text-white hover:bg-slate-800">Clear</button>
        </div>

        <p id="statusText" class="mt-4 text-sm text-slate-600"></p>
      </div>
    </section>

    <section id="features" class="bg-white py-14 mt-12">
      <div class="mx-auto max-w-7xl px-4 md:px-6">
        <h2 class="text-center text-3xl font-bold">Why this is startup-ready</h2>
        <div class="mt-8 grid gap-5 md:grid-cols-3">
          <article class="rounded-xl border border-slate-200 p-5">
            <h3 class="font-semibold">Modern UI</h3>
            <p class="mt-2 text-sm text-slate-600">Clean sections, clear CTA buttons, and trust-first visual style for Indian users.</p>
          </article>
          <article class="rounded-xl border border-slate-200 p-5">
            <h3 class="font-semibold">Backend API</h3>
            <p class="mt-2 text-sm text-slate-600">Includes Node/Express auth + usage endpoints to support free/pro business model.</p>
          </article>
          <article class="rounded-xl border border-slate-200 p-5">
            <h3 class="font-semibold">Deployment files</h3>
            <p class="mt-2 text-sm text-slate-600">Procfile + render.yaml added so you can deploy quickly without setup confusion.</p>
          </article>
        </div>
      </div>
    </section>

    <section id="pricing" class="py-14">
      <div class="mx-auto max-w-7xl px-4 md:px-6">
        <h2 class="text-center text-3xl font-bold">Simple pricing</h2>
        <div class="mx-auto mt-8 grid max-w-3xl gap-4 md:grid-cols-2">
          <div class="rounded-xl border border-slate-200 bg-white p-6">
            <p class="text-sm font-semibold text-slate-500">Free</p>
            <p class="mt-2 text-3xl font-bold">â‚¹0</p>
            <ul class="mt-4 space-y-2 text-sm text-slate-600">
              <li>â€¢ 5 conversions/day</li>
              <li>â€¢ Watermark included</li>
            </ul>
          </div>
          <div class="rounded-xl border-2 border-blue-600 bg-white p-6 shadow">
            <p class="text-sm font-semibold text-blue-600">Pro</p>
            <p class="mt-2 text-3xl font-bold">â‚¹199<span class="text-base font-medium text-slate-500"> / month</span></p>
            <ul class="mt-4 space-y-2 text-sm text-slate-600">
              <li>â€¢ Unlimited conversions</li>
              <li>â€¢ No watermark</li>
              <li>â€¢ Priority support</li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-slate-900 py-10 text-center text-slate-200">
    <h3 class="text-xl font-bold">Snap2PDF</h3>
    <p class="mt-2 text-sm text-slate-400">Made for Indiaâ€™s next tech success story.</p>
    <p class="mt-1 text-sm text-slate-400">Email: founder@snap2pdf.in</p>
  </footer>

  <script>
    const { jsPDF } = window.jspdf;
    const API_BASE = window.location.origin;

    const nameInput = document.getElementById("name");
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const authMessage = document.getElementById("authMessage");
    const authBadge = document.getElementById("authBadge");

    const fileInput = document.getElementById("fileInput");
    const preview = document.getElementById("preview");
    const convertBtn = document.getElementById("convertBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    const clearBtn = document.getElementById("clearBtn");
    const statusText = document.getElementById("statusText");
    const dropzone = document.getElementById("dropzone");

    let images = [];
    let pdfDoc = null;
    let usage = 0;
    let isPro = false;
    let token = localStorage.getItem("token") || "";

    function authHeaders() {
      return token ? { Authorization: `Bearer ${token}` } : {};
    }

    function setMessage(target, text, tone = "normal") {
      target.textContent = text;
      target.className = tone === "error" ? "self-center text-sm text-red-600" : "self-center text-sm text-slate-600";
    }

    async function refreshUsageAndPlan() {
      const response = await fetch(`${API_BASE}/api/usage`, { headers: { ...authHeaders() } });
      const data = await response.json();
      usage = Number(data.usage || 0);
      isPro = Boolean(data.isPro);
      const userType = token ? "Logged In" : "Guest";
      authBadge.textContent = `${userType}${isPro ? " â€¢ Pro" : " â€¢ Free"} â€¢ Usage: ${usage}`;
    }

    async function refreshMe() {
      if (!token) {
        authBadge.textContent = "Guest";
        return refreshUsageAndPlan();
      }

      const response = await fetch(`${API_BASE}/api/me`, { headers: { ...authHeaders() } });
      if (response.status === 401) {
        token = "";
        localStorage.removeItem("token");
        return refreshUsageAndPlan();
      }

      const data = await response.json();
      authBadge.textContent = `${data.user.name} â€¢ ${data.user.isPro ? "Pro" : "Free"}`;
      return refreshUsageAndPlan();
    }

    document.getElementById("signupBtn").addEventListener("click", async () => {
      const payload = {
        name: nameInput.value.trim(),
        email: emailInput.value.trim(),
        password: passwordInput.value
      };

      const response = await fetch(`${API_BASE}/api/auth/signup`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      const data = await response.json();
      setMessage(authMessage, data.message, response.ok ? "normal" : "error");
    });

    document.getElementById("loginBtn").addEventListener("click", async () => {
      const payload = {
        email: emailInput.value.trim(),
        password: passwordInput.value
      };

      const response = await fetch(`${API_BASE}/api/auth/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      const data = await response.json();
      if (!response.ok || !data.token) {
        setMessage(authMessage, data.message || "Login failed", "error");
        return;
      }

      token = data.token;
      localStorage.setItem("token", token);
      setMessage(authMessage, "Login successful");
      await refreshMe();
    });

    document.getElementById("activateProBtn").addEventListener("click", async () => {
      if (!token) {
        return setMessage(authMessage, "Login first to activate Pro.", "error");
      }
      const response = await fetch(`${API_BASE}/api/pro/activate`, {
        method: "POST",
        headers: { ...authHeaders() }
      });
      const data = await response.json();
      setMessage(authMessage, data.message || "Failed", response.ok ? "normal" : "error");
      await refreshMe();
    });

    document.getElementById("logoutBtn").addEventListener("click", async () => {
      token = "";
      localStorage.removeItem("token");
      setMessage(authMessage, "Logged out");
      await refreshMe();
    });

    function renderPreview() {
      preview.innerHTML = "";
      images.forEach((entry, index) => {
        const wrap = document.createElement("div");
        wrap.className = "group relative overflow-hidden rounded-lg border border-slate-200 bg-white";
        wrap.innerHTML = `
          <img src="${entry.original}" alt="uploaded-${index + 1}" class="h-24 w-full object-cover" />
          <div class="absolute bottom-1 left-1 rounded bg-black/60 px-2 py-0.5 text-xs text-white">Page ${index + 1}</div>
        `;
        preview.appendChild(wrap);
      });
    }

    function imageToCompressedDataUrl(inputUrl, quality) {
      return new Promise((resolve) => {
        const img = new Image();
        img.onload = () => {
          const canvas = document.createElement("canvas");
          canvas.width = img.width;
          canvas.height = img.height;
          canvas.getContext("2d").drawImage(img, 0, 0);
          resolve(canvas.toDataURL("image/jpeg", quality));
        };
        img.src = inputUrl;
      });
    }

    async function loadFiles(files) {
      images = [];
      for (const file of files) {
        const base64 = await new Promise((resolve) => {
          const reader = new FileReader();
          reader.onload = (e) => resolve(e.target.result);
          reader.readAsDataURL(file);
        });
        images.push({ original: base64 });
      }
      renderPreview();
      statusText.textContent = `${images.length} image(s) ready.`;
    }

    fileInput.addEventListener("change", async (event) => {
      const files = Array.from(event.target.files || []);
      await loadFiles(files);
    });

    ["dragenter", "dragover"].forEach((eventName) => {
      dropzone.addEventListener(eventName, (event) => {
        event.preventDefault();
        dropzone.classList.add("dropzone-active");
      });
    });

    ["dragleave", "drop"].forEach((eventName) => {
      dropzone.addEventListener(eventName, (event) => {
        event.preventDefault();
        dropzone.classList.remove("dropzone-active");
      });
    });

    dropzone.addEventListener("drop", async (event) => {
      const files = Array.from(event.dataTransfer.files || []).filter((file) => file.type.startsWith("image/"));
      if (!files.length) return;
      await loadFiles(files);
    });

    convertBtn.addEventListener("click", async () => {
      if (!images.length) {
        statusText.textContent = "Please upload at least one image first.";
        return;
      }

      await refreshUsageAndPlan();
      if (!isPro && usage >= 5) {
        statusText.textContent = "Free limit reached (5/day). Activate Pro for unlimited conversions.";
        return;
      }

      const pageSizeValue = document.getElementById("pageSize").value;
      const margin = Number(document.getElementById("margin").value || 10);
      const quality = Number(document.getElementById("quality").value || 0.8);
      const formats = { a4: [210, 297], letter: [216, 279] };

      pdfDoc = new jsPDF({ unit: "mm", format: formats[pageSizeValue] });
      const pageWidth = pdfDoc.internal.pageSize.getWidth();
      const pageHeight = pdfDoc.internal.pageSize.getHeight();

      const cards = Array.from(document.querySelectorAll("#preview img"));
      for (let i = 0; i < cards.length; i += 1) {
        if (i > 0) pdfDoc.addPage();
        const compressed = await imageToCompressedDataUrl(cards[i].src, quality);
        pdfDoc.addImage(compressed, "JPEG", margin, margin, pageWidth - 2 * margin, pageHeight - 2 * margin, undefined, "FAST");
        if (!isPro) {
          pdfDoc.setTextColor(180);
          pdfDoc.setFontSize(9);
          pdfDoc.text("Snap2PDF Free", pageWidth / 2, pageHeight - 5, { align: "center" });
        }
      }

      if (!isPro) {
        await fetch(`${API_BASE}/api/usage/increment`, {
          method: "POST",
          headers: { ...authHeaders() }
        });
        await refreshUsageAndPlan();
      }

      downloadBtn.classList.remove("hidden");
      statusText.textContent = `PDF ready. Compression ${quality}`;
    });

    downloadBtn.addEventListener("click", () => {
      if (pdfDoc) pdfDoc.save("snap2pdf.pdf");
    });

    clearBtn.addEventListener("click", () => {
      images = [];
      pdfDoc = null;
      fileInput.value = "";
      preview.innerHTML = "";
      downloadBtn.classList.add("hidden");
      statusText.textContent = "Cleared.";
    });

    new Sortable(preview, {
      animation: 150,
      onEnd: () => {
        const ordered = Array.from(document.querySelectorAll("#preview img")).map((img) => img.src);
        images = ordered.map((src) => ({ original: src }));
        renderPreview();
      }
    });

    refreshMe();
  </script>
</body>
</html>
